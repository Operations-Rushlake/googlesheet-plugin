{
  "id": "googlesheet_plugin_001",
  "code": "async function googlesheet_plugin_001({ spreadsheetId, range, values, title, query, action }, context) {\n const token = context.auth.access_token;\n\n if (action === 'read') {\n if (!spreadsheetId || !range) throw new Error('Missing spreadsheetId or range for read action');\n const res = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${encodeURIComponent(range)}`, {\n headers: { Authorization: `Bearer ${token}` }\n });\n if (!res.ok) throw new Error(`Google API Error: ${res.status} ${await res.text()}`);\n return await res.json();\n\n } else if (action === 'write') {\n if (!spreadsheetId || !range || !values) throw new Error('Missing spreadsheetId, range, or values for write action');\n const res = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${encodeURIComponent(range)}?valueInputOption=RAW`, {\n method: 'PUT',\n headers: { Authorization: `Bearer ${token}`, 'Content-Type': 'application/json' },\n body: JSON.stringify({ values })\n });\n if (!res.ok) throw new Error(`Google API Error: ${res.status} ${await res.text()}`);\n return await res.json();\n\n } else if (action === 'create') {\n if (!title) throw new Error('Missing title for new spreadsheet');\n const res = await fetch('https://sheets.googleapis.com/v4/spreadsheets', {\n method: 'POST',\n headers: { Authorization: `Bearer ${token}`, 'Content-Type': 'application/json' },\n body: JSON.stringify({ properties: { title } })\n });\n if (!res.ok) throw new Error(`Google API Error: ${res.status} ${await res.text()}`);\n return await res.json();\n\n } else if (action === 'list_drive_files') {\n let url = 'https://www.googleapis.com/drive/v3/files';\n const params = new URLSearchParams({ fields: 'files(id, name, mimeType, modifiedTime)' });\n if (query) {\n params.append('q', query);\n }\n const res = await fetch(`${url}?${params.toString()}`, {\n headers: { Authorization: `Bearer ${token}` }\n });\n if (!res.ok) throw new Error(`Google API Error: ${res.status} ${await res.text()}`);\n return await res.json();\n\n } else {\n throw new Error('Invalid action. Use \"read\", \"write\", \"create\", or \"list_drive_files\"');\n }\n}",
  "icon": "https://www.gstatic.com/images/branding/product/1x/sheets_48dp.png",
  "uuid": "a312bac6-10f1-4555-a06b-37dedaff603b",
  "emoji": "ðŸ§©",
  "title": "Google Sheets & Drive Plugin",
  "system": false,
  "iconURL": "https://www.gstatic.com/images/branding/product/1x/sheets_48dp.png",
  "disabled": false,
  "openaiSpec": {
    "name": "googlesheet_plugin_001",
    "parameters": {
      "type": "object",
      "required": [
        "action"
      ],
      "properties": {
        "range": {
          "type": "string",
          "description": "The A1 notation of the range to read or update (e.g. 'Sheet1!A1:C10')"
        },
        "title": {
          "type": "string",
          "description": "Title of the new spreadsheet (required if action=create)"
        },
        "action": {
          "enum": [
            "read",
            "write",
            "create",
            "list_drive_files"
          ],
          "type": "string",
          "description": "Whether to read/write a sheet, create a sheet, or list files from Google Drive"
        },
        "values": {
          "type": "array",
          "items": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "description": "2D array of values to update (required if writing data)"
        },
        "spreadsheetId": {
          "type": "string",
          "description": "The ID of the Google Sheet (not needed if action=create)"
        },
        "query": {
          "type": "string",
          "description": "A query for filtering Drive files. See Drive API 'Search for files' guide. E.g., \"mimeType='application/vnd.google-apps.spreadsheet'\" to list only Sheets."
        }
      }
    },
    "description": "Interact with Google Sheets and list files from Google Drive using OAuth2.0 authentication"
  },
  "outputType": "respond_to_ai",
  "oauthConfig": {
    "prompt": "consent",
    "scopes": "openid profile email https://www.googleapis.com/auth/drive.readonly https://www.googleapis.com/auth/spreadsheets",
    "tokenURL": "https://oauth2.googleapis.com/token",
    "accessType": "offline",
    "contentType": "json",
    "authorizationURL": "https://accounts.google.com/o/oauth2/v2/auth"
  },
  "userSettings": [
    {
      "name": "OAUTH_CLIENT_ID",
      "label": "OAuth Client ID",
      "required": true,
      "description": "Your Google OAuth 2.0 Client ID"
    },
    {
      "name": "OAUTH_CLIENT_SECRET",
      "type": "password",
      "label": "OAuth Client Secret",
      "required": true,
      "description": "Your Google OAuth 2.0 Client Secret"
    },
    {
      "name": "OAUTH_REDIRECT_URI",
      "label": "OAuth Redirect URI",
      "required": true,
      "description": "The redirect URI configured in your Google Cloud OAuth2 credentials"
    }
  ],
  "isServerPlugin": true,
  "overviewMarkdown": "## Google Sheets & Drive Plugin\n\nRead, update, or create Google Sheets and list/search for files in Google Drive using OAuth2 authentication.",
  "turnedOnByDefault": true,
  "authenticationType": "AUTH_TYPE_NONE",
  "implementationType": "javascript"
}
